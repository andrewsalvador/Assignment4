---
title: "Assignment 4 Lobsters"
author: "Andrew Salvador & Benson Truong"
date: "11/12/2019"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)

```


```{r}
library(tidyverse)
library(janitor)
```


```{r}
lobster_data <- read_csv("lobster_abundance_sbc_lter.csv") %>% 
  clean_names() 

lobster_data_clean <- lobster_data %>% 
  tidyr::uncount(count)

lobster_bysite <- lobster_data_clean %>% 
  count(year, site)

```



```{r}
# RESULTS A
# IVEE LOBSTER COUNT

lobster_ivee <- lobster_bysite %>% 
  filter(site %in% c("IVEE"))
  
lobster_factorivee <- lobster_ivee %>% 
  mutate(year = as.character(year)) 


ggplot(lobster_factorivee, aes(x = year,
                           y = n)) +
  geom_col(width = .8) +
  labs(x = "Year",
       y = "Count",
       title = "Lobster count in Isla Vista (MPA) 2012-2018") +
  scale_y_continuous(limits = c(0, 1000), expand = c(0,0)) 
  



```

  
```{r}
#RESULTS A:
#CARP LOBSTER COUNT
lobster_carp <- lobster_bysite %>% 
  filter(site %in% c("CARP"))
  
lobster_factorcarp <- lobster_carp %>% 
  mutate(year = as.character(year)) 


ggplot(lobster_factorcarp, aes(x = year,
                           y = n)) +
  geom_col(width = .8) +
  labs(x = "Year",
       y = "Count",
       title = "Lobster count in Carpinteria (Non-MPA) 2012-2018") +
  scale_y_continuous(limits = c(0, 750), expand = c(0,0)) 

```


```{r}

#RESULTS A
#MOHAWK Lobster count 2012-2018

lobster_mohk <- lobster_bysite %>% 
  filter(site %in% c("MOHK"))
  
lobster_factormohk <- lobster_mohk %>% 
  mutate(year = as.character(year)) 


ggplot(lobster_factormohk, aes(x = year,
                           y = n)) +
  geom_col(width = .8) +
  labs(x = "Year",
       y = "Count",
       title = "Lobster count in Mohawk (Non-MPA) 2012-2018") +
  scale_y_continuous(limits = c(0, 350), expand = c(0,0)) 
```

```{r}
# RESULTS A
#NAPLES (NAPL) Lobster count

lobster_napl <- lobster_bysite %>% 
  filter(site %in% c("MOHK"))
  
lobster_factornapl <- lobster_napl %>% 
  mutate(year = as.character(year)) 


ggplot(lobster_factornapl, aes(x = year,
                           y = n)) +
  geom_col(width = .8) +
  labs(x = "Year",
       y = "Count",
       title = "Lobster count in Naples (MPA) 2012-2018") +
  scale_y_continuous(limits = c(0, 350), expand = c(0,0)) 
```


```{r}
# RESULTS A
# ARROYO QUEMADO (AQUE) Lobster count

lobster_aque <- lobster_bysite %>% 
  filter(site %in% c("AQUE"))
  
lobster_factoraque <- lobster_aque %>% 
  mutate(year = as.character(year)) 


ggplot(lobster_factoraque, aes(x = year,
                           y = n)) +
  geom_col(width = .8) +
  labs(x = "Year",
       y = "Count",
       title = "Lobster count in Arroyo Quemado (Non-MPA) 2012-2018") +
  scale_y_continuous(limits = c(0, 125), expand = c(0,0)) 
```
























































































































































```{r}
lobster_aque <- lobster_bysite %>% 
  filter(site == "AQUE")

ggplot(data = lobster_aque, aes(x = year, y = n))+
  geom_col()

```


